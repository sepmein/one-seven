# Analysis File Creation {#sec-fcreate-zam}

```{r}
#| label: zam_analysis_file_creation_library
#| message: false
#| echo: fenced
#| warning: false
require(readxl)
require(readr)
require(Hmisc)
require(here)
require(data.table)
require(lubridate)
```

## Raw data

Zambia submitted data to WHO at 23th, July, 2024.

16 files were submitted:

-   **DHIS2**

    -   HMIS data Lukwipa and Kankumba.xls

    -   Weekly data.xlsx

-   **Surveys**

    -   1,7_experiment_data_status.xlsx

    -   Baseline and Endline Survey- Codebook.xlsx

    -   **Baseline**

        -   census_phone_combine.csv

        -   household_member_phone_combine.csv

        -   household_phone_combine.csv

        -   net_phone_combine.csv

        -   Rufunsa 1,7mRCT BASE-LINE MICROSCOPY RESULTS final.xlsx

        -   visit_phone_combine.csv

    -   **Endline**

        -   1,7 Parasite Microscope endline survey 2023 results_updated Rufunsa_version.xlsx

        -   Endline household_member_all.csv

        -   Endline-census.xls

        -   Endline-household.xls

        -   Endline-net.xls

        -   Endline-visit.xls

### Data Pathes

```{r}
#| label: zam_raw_data_path
# DHIS2
PATH_ZAM_DH_HF_RAW_240723 <- "2_data/zam/1_raw/HMIS data Lukwipa and Kankumba.xls"
PATH_ZAM_DH_VL_RAW_240723 <- "2_data/zam/1_raw/Weekly data.xlsx"

# Survey
PATH_ZAM_HH_HH_RAW_240723 <- "2_data/zam/1_raw/1,7_experiment_data_status.xlsx"
PATH_ZAM_HH_CODEBOOK_RAW_240723 <- "2_data/zam/1_raw/Baseline and Endline Survey- Codebook.xlsx"

# Baseline
PATH_ZAM_HHB_HH_HOUSEINFO_RAW_240723 <- "2_data/zam/1_raw/Baseline and Endline Data/Baseline Survey Dataset/census_phone_combine.csv"
PATH_ZAM_HHB_PR_RAW_240723 <- "2_data/zam/1_raw/Baseline and Endline Data/Baseline Survey Dataset/household_member_phone_combine.csv"
PATH_ZAM_HHB_HH_DETAILED_HOUSEINFO_RAW_240723 <- "2_data/zam/1_raw/Baseline and Endline Data/Baseline Survey Dataset/household_phone_combine.csv"
PATH_ZAM_HHB_HH_ITN_RAW_240723 <- "2_data/zam/1_raw/Baseline and Endline Data/Baseline Survey Dataset/net_phone_combine.csv"
PATH_ZAM_HHB_HH_TEST_RAW_240723 <- "2_data/zam/1_raw/Baseline and Endline Data/Baseline Survey Dataset/Rufunsa 1,7mRCT BASE-LINE MICROSCOPY RESULTS final.xlsx"
PATH_ZAM_HHB_HH_VISIT_RAW_240723 <- "2_data/zam/1_raw/Baseline and Endline Data/Baseline Survey Dataset/visit_phone_combine.csv"

# Endline
PATH_ZAM_HHE_HH_HOUSEINFO_RAW_240723 <- "2_data/zam/1_raw/Baseline and Endline Data/Endline Survey Dataset/Endline-census.xlsx"
PATH_ZAM_HHE_PR_RAW_240723 <- "2_data/zam/1_raw/Baseline and Endline Data/Endline Survey Dataset/Endline household_member_all.csv"
PATH_ZAM_HHE_HH_DETAILED_HOUSEINFO_RAW_240723 <- "2_data/zam/1_raw/Baseline and Endline Data/Endline Survey Dataset/Endline-household.xlsx"
PATH_ZAM_HHE_HH_ITN_RAW_240723 <- "2_data/zam/1_raw/Baseline and Endline Data/Endline Survey Dataset/Endline-net.xlsx"
PATH_ZAM_HHE_HH_TEST_RAW_240723 <- "2_data/zam/1_raw/Baseline and Endline Data/Endline Survey Dataset/1,7 Parasite Microscope endline survey 2023 results_updated Rufunsa_version.xlsx"
PATH_ZAM_HHE_HH_VISIT_RAW_240723 <- "2_data/zam/1_raw/Baseline and Endline Data/Endline Survey Dataset/Endline-visit.xlsx"

```

### Load Data

```{r}
#| label: zam_load_raw_data
#| warning: false
#| message: false

# DHIS2
zam_dh_hf_raw <- read_excel(here(PATH_ZAM_DH_HF_RAW_240723) , skip = 1)
zam_dh_vl_raw <- read_excel(here(PATH_ZAM_DH_VL_RAW_240723) , skip = 2)

# Survey
zam_hh_hh_raw <- read_excel(here(PATH_ZAM_HH_HH_RAW_240723))
zam_hh_codebook_raw <- read_excel(here(PATH_ZAM_HH_CODEBOOK_RAW_240723))

## Baseline
zam_hhb_hh_houseinfo_raw <- fread(here(PATH_ZAM_HHB_HH_HOUSEINFO_RAW_240723))
zam_hhb_pr_raw <- fread(here(PATH_ZAM_HHB_PR_RAW_240723))
zam_hhb_hh_detailed_houseinfo_raw <- fread(here(PATH_ZAM_HHB_HH_DETAILED_HOUSEINFO_RAW_240723))
zam_hhb_hh_itn_raw <- fread(here(PATH_ZAM_HHB_HH_ITN_RAW_240723))
zam_hhb_hh_test_raw <- read_excel(here(PATH_ZAM_HHB_HH_TEST_RAW_240723))
zam_hhb_hh_visit_raw <- fread(here(PATH_ZAM_HHB_HH_VISIT_RAW_240723))

## Endline
zam_hhe_hh_houseinfo_raw <- read_excel(here(PATH_ZAM_HHE_HH_HOUSEINFO_RAW_240723))
zam_hhe_pr_raw <- fread(here(PATH_ZAM_HHE_PR_RAW_240723))
zam_hhe_hh_detailed_houseinfo_raw <- read_excel(here(PATH_ZAM_HHE_HH_DETAILED_HOUSEINFO_RAW_240723))
zam_hhe_hh_itn_raw <- read_excel(here(PATH_ZAM_HHE_HH_ITN_RAW_240723))
zam_hhe_hh_test_raw <- read_excel(here(PATH_ZAM_HHE_HH_TEST_RAW_240723))
zam_hhe_hh_visit_raw <- read_excel(here(PATH_ZAM_HHE_HH_VISIT_RAW_240723))
```

```{r}
#| label: zam-updata-dh-hf
#| lst-label: zam-updata-dh-hf
#| lst-cap: Recode HFCA data from DHIS2, Zambia
zam_dh_hf <- upData(
  zam_dh_hf_raw,
  YEAR = my(periodname) |> year(),
  MONTH = my(periodname) |> month(),
  rename = .q(organisationunitname = HFCA,
              "Malaria Clinical Cases" = MC_CLN,
              "Malaria Confirmed Cases" = MC_CFM 
              )
)
```

see @sec-data-meta-date, @sec-data-meta-administrative, @sec-meta-data-malaria for more information.
